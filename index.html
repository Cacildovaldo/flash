<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sistema Flash Loan</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(145deg, #0f2027, #203a43, #2c5364);
      color: #ffffff;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      background-color: #1e2a38;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      max-width: 500px;
      width: 90%;
      text-align: center;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }

    button {
      background-color: #00c896;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      color: white;
      cursor: pointer;
      border-radius: 8px;
      margin-top: 20px;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #00b386;
    }

    #walletAddress {
      margin-top: 15px;
      font-size: 14px;
      color: #a0e8d1;
    }

    .status {
      margin-top: 10px;
      font-size: 14px;
      color: #ffcc00;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Executar Flash Loan</h1>
    <button id="connectButton">Conectar MetaMask</button>
    <div id="walletAddress">Carteira: Não conectada</div>
    <button id="executeButton">Executar Operação</button>
    <div class="status" id="statusMessage"></div>
  </div>

  <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
  <script>
    const contractAddress = "SEU_CONTRATO_DEPLOYADO_AQUI"; // Substitua pelo endereço do contrato

    const abi = [
      "function startArbitrage(uint256 amount, address specificToken) external",
      "function getTargetTokens() view returns (address[])",
      "function owner() view returns (address)",
      "function profitReceiver() view returns (address)",
      "function maxLoanAmount() view returns (uint256)",
      "function minProfit() view returns (uint256)",
      "function baseSlippage() view returns (uint256)",
      "function buySlippageMultiplier() view returns (uint256)",
      "function buyDEX() view returns (uint8)",
      "function sellDEX() view returns (uint8)",
      "function flashLoanProvider() view returns (uint8)",
      "function addTargetToken(address token)",
      "function removeTargetToken(address token)",
      "function setConfig(uint256 _maxLoanAmount, uint256 _minProfit)",
      "function setDEX(uint8 _buyDEX, uint8 _sellDEX)",
      "function setFlashLoanProvider(uint8 _provider)",
      "function setSlippage(uint256 _baseSlippage, uint256 _buyMultiplier)",
      "event OperationExecuted(address indexed token, uint256 amount, uint256 profit)"
    ];

    let provider;
    let signer;
    let contract;

    async function connectWallet() {
      if (window.ethereum) {
        try {
          provider = new ethers.providers.Web3Provider(window.ethereum);
          await provider.send("eth_requestAccounts", []);
          signer = provider.getSigner();
          const address = await signer.getAddress();
          document.getElementById("walletAddress").textContent = "Carteira: " + address;

          contract = new ethers.Contract(contractAddress, abi, signer);
          document.getElementById("statusMessage").textContent = "Conectado com sucesso!";
        } catch (err) {
          console.error(err);
          document.getElementById("statusMessage").textContent = "Erro ao conectar: " + err.message;
        }
      } else {
        alert("MetaMask não encontrada. Instale a extensão no seu navegador.");
      }
    }

    async function executeFlashLoan() {
      if (!contract) {
        document.getElementById("statusMessage").textContent = "Conecte a carteira primeiro.";
        return;
      }

      try {
        const amount = ethers.utils.parseEther("1.0"); // 1 MATIC como exemplo
        const specificToken = ethers.constants.AddressZero; // ou substitua por token específico

        const tx = await contract.startArbitrage(amount, specificToken);
        document.getElementById("statusMessage").textContent = "Transação enviada: " + tx.hash;
        await tx.wait();
        document.getElementById("statusMessage").textContent = "Flash Loan executado com sucesso!";
      } catch (err) {
        console.error(err);
        document.getElementById("statusMessage").textContent = "Erro na execução: " + err.message;
      }
    }

    document.getElementById("connectButton").addEventListener("click", connectWallet);
    document.getElementById("executeButton").addEventListener("click", executeFlashLoan);
  </script>
</body>
</html>
